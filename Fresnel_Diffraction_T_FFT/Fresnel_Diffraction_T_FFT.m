r=512;c=r;
a=zeros(r,c);
a(r/2-r/4:r/2+r/4,c/2-c/4:c/2+c/4)=1;
lamda=6328e-10;
k=2*pi/lamda;
L0=5e-3;
d=0.1;
x0=linspace(-L0/2,L0/2,c);
y0=linspace(-L0/2,L0/2,r);
[x0,y0]=meshgrid(x0,y0);

F0=exp(1j*k*d)/(1j*lamda*d);
F1=exp(1j*k/2/d*(x0.^2+y0.^2));
fa=fft2(a);
fF1=fft2(F1);
Fuf=fa.*fF1;
U=F0.*fftshift(ifft2(Fuf));
I=U.*conj(U);
figure,imshow(I,[0,max(max(I))]),colormap(gray)
figure,imshow(max(max(I))-I,[]),colormap(gray)